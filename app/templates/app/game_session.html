{% comment %} 

OBJECTIVE:
Place Holder for "base.html" and static objects
{% extends "base.html" %}
{% load static %} 

STAUTS:
base.html and static are in development

{% endcomment %}

<style>>
    {% block style %}
    .container {
        height: 200px;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    
    .item {
        width: 10em;
    }
    
    .center {
        margin: auto;
        width: 60%;
        padding: 10px;
        text-align: center;
        border: 3px solid blue;
      }
    {% endblock %}
    </style>
    
    {% block body %} 
    <div class="center">
        Room {{game.id}}
    </div>
    

        <div class='center'>
          <div id='player_list' style='max-height: 300px; overflow-y:scroll;'>
            {% for player in player_list  %} {{ player.username}}<br>{% endfor %}
          </div>
        </div>

        <div style='padding:10px ; text-align:center'>
            <button href="{% url 'app:start_page' %}" >Leave Room</button>
            {% if player.is_host == True %}
                <a href="{% url 'app:team_creation' player_game=game.id player_id=player.id %}">
                    <button type="submit">Start Game</button>
                </a>
            {% endif %} 
        </div>

        {{ game_id|json_script:'json-game-id' }}
        {{ username|json_script:'json-username' }}

<script>
    const gameID = JSON.parse(document.getElementById('json-game-id').textContent);
    const userName = JSON.parse(document.getElementById('json-username').textContent);

    document.addEventListener('DOMContentLoaded', () => {
        const sessionSocket = new WebSocket(
            'ws://'
            + window.location.host
            + '/ws/game_session/'
            + gameID
          );
        
        sessionSocket.onopen = (e) => {
            message= '';
            console.log('socket opened!');
            sessionSocket.send(JSON.stringify({
                'message': message,
                'username': userName,
                'room': gameID,
              }));
        };

        sessionSocket.onmessage = function(e) {
            console.log('onmessage');
            const data = JSON.parse(e.data);
            console.log(data);
          
            if (data.username) {
              document.querySelector('#player_list').innerHTML += ('<b>' + data.username + '</b>: ' + '</br>');
              console.log('username added to list');
            } else {
              alert('The message was empty!')
            }
          };

    });
          
</script>
    {% endblock %}